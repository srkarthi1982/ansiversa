---
import SectionHeading from '../../../components/SectionHeading.astro';
---
<section
  class="relative overflow-hidden bg-gradient-to-b from-indigo-50 via-white to-white pb-20 pt-16 sm:pt-20"
  x-data="() => ({ timer: $store.studyTimer })"
>
  <div class="absolute inset-0 pointer-events-none">
    <div class="absolute left-1/2 top-12 h-72 w-72 -translate-x-1/2 rounded-full bg-indigo-200/40 blur-3xl"></div>
    <div class="absolute bottom-0 right-12 h-64 w-64 rounded-full bg-purple-200/40 blur-3xl"></div>
  </div>
  <div class="relative mx-auto flex max-w-6xl flex-col gap-16 px-4 sm:px-6 lg:flex-row lg:items-center lg:gap-12 lg:px-8">
    <div class="max-w-2xl space-y-8">
      <SectionHeading
        eyebrow="Laser-focus timing"
        title="Study Timer"
        description="Pomodoro power, distraction tracking, and streak-loving analytics — all tuned for high-intent study sessions."
      />
      <ul class="grid gap-4 sm:grid-cols-2">
        <li class="flex items-start gap-3 rounded-2xl border border-indigo-100/80 bg-white/70 p-4 shadow-sm backdrop-blur">
          <span class="mt-1 flex h-9 w-9 items-center justify-center rounded-full bg-indigo-500 text-white">
            <i class="fas fa-bolt text-sm"></i>
          </span>
          <div class="space-y-1">
            <p class="text-sm font-semibold text-slate-900">Preset mastery</p>
            <p class="text-sm text-slate-600">
              Switch between Pomodoro, long-focus, or custom cycles without losing your streaks.
            </p>
          </div>
        </li>
        <li class="flex items-start gap-3 rounded-2xl border border-indigo-100/80 bg-white/70 p-4 shadow-sm backdrop-blur">
          <span class="mt-1 flex h-9 w-9 items-center justify-center rounded-full bg-sky-500 text-white">
            <i class="fas fa-person-running text-sm"></i>
          </span>
          <div class="space-y-1">
            <p class="text-sm font-semibold text-slate-900">Interruption intelligence</p>
            <p class="text-sm text-slate-600">
              Log distractions, tag reasons, and spot patterns before they erode your focus time.
            </p>
          </div>
        </li>
        <li class="flex items-start gap-3 rounded-2xl border border-indigo-100/80 bg-white/70 p-4 shadow-sm backdrop-blur">
          <span class="mt-1 flex h-9 w-9 items-center justify-center rounded-full bg-emerald-500 text-white">
            <i class="fas fa-ranking-star text-sm"></i>
          </span>
          <div class="space-y-1">
            <p class="text-sm font-semibold text-slate-900">Goal-fuelled stats</p>
            <p class="text-sm text-slate-600">
              Daily and weekly goals update in real time — celebrate streaks as they happen.
            </p>
          </div>
        </li>
        <li class="flex items-start gap-3 rounded-2xl border border-indigo-100/80 bg-white/70 p-4 shadow-sm backdrop-blur">
          <span class="mt-1 flex h-9 w-9 items-center justify-center rounded-full bg-purple-500 text-white">
            <i class="fas fa-diagram-project text-sm"></i>
          </span>
          <div class="space-y-1">
            <p class="text-sm font-semibold text-slate-900">Planner-ready</p>
            <p class="text-sm text-slate-600">
              Send sessions to Study Planner, FlashNote, or Quiz Institute with a single action.
            </p>
          </div>
        </li>
      </ul>
      <div class="flex flex-wrap items-center gap-4 rounded-2xl border border-indigo-100/80 bg-white/70 p-6 shadow-sm backdrop-blur">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.25em] text-indigo-500">Today</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900" x-text="`${timer.state.totalFocusMinutesToday} focus minutes`"></p>
          <p class="text-sm text-slate-600">
            Goal
            <span class="font-semibold text-indigo-600" x-text="`${timer.state.goal.targetDailyMinutes} min`"></span>
            · Pomodoros
            <span class="font-semibold text-indigo-600" x-text="timer.state.completedPomodorosToday"></span>
          </p>
        </div>
        <div class="hidden h-14 w-px bg-gradient-to-b from-indigo-200 via-indigo-100 to-transparent sm:block"></div>
        <div class="flex flex-1 flex-col gap-3 sm:flex-row sm:items-center">
          <button
            type="button"
            class="inline-flex items-center gap-2 rounded-full bg-indigo-600 px-5 py-2.5 text-sm font-semibold text-white shadow-lg transition hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
            @click="timer.toggleTimer()"
          >
            <i class="fas" :class="timer.state.isRunning ? 'fa-pause' : 'fa-play'"></i>
            <span x-text="timer.state.isRunning ? 'Pause focus' : 'Start focus'"></span>
          </button>
          <button
            type="button"
            class="inline-flex items-center justify-center rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:border-indigo-200 hover:text-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
            @click="timer.resetTimer()"
          >
            <i class="fas fa-rotate-left text-xs"></i>
            Reset
          </button>
        </div>
      </div>
    </div>
    <div class="relative w-full max-w-sm self-stretch">
      <div class="absolute inset-x-10 top-10 h-64 rounded-[36px] bg-indigo-200/60 blur-3xl"></div>
      <article class="relative h-full rounded-[32px] border border-indigo-100 bg-white p-8 shadow-2xl">
        <div class="flex items-center justify-between text-sm text-slate-500">
          <span class="inline-flex items-center gap-2 rounded-full bg-indigo-50 px-3 py-1 font-semibold text-indigo-600">
            <i class="fas fa-stopwatch-20 text-xs"></i>
            <span x-text="timer.activePreset?.name ?? 'Preset'">Preset</span>
          </span>
          <span class="font-medium text-slate-700" x-text="timer.describePreset()"></span>
        </div>
        <div class="mt-8 flex flex-col items-center gap-6">
          <div class="relative flex h-52 w-52 items-center justify-center">
            <div
              class="absolute inset-0 rounded-full border-[12px] border-slate-100"
              :style="`mask: radial-gradient(circle at center, transparent calc(50% - 18px), black calc(50% - 18px));`"
            ></div>
            <div
              class="absolute inset-0 rounded-full"
              :style="`background: conic-gradient(#4338ca ${Math.round(timer.phaseProgress * 360)}deg, #e0e7ff ${Math.round(timer.phaseProgress * 360)}deg);`"
            ></div>
            <div class="relative flex h-36 w-36 flex-col items-center justify-center rounded-full bg-white text-center shadow-inner">
              <p class="text-xs font-semibold uppercase tracking-wide text-indigo-500" x-text="timer.state.phase === 'countup' ? 'Count-up' : timer.state.phase === 'idle' ? 'Ready' : timer.state.phase.replace('_',' ')"></p>
              <p class="mt-2 text-4xl font-bold tabular-nums text-slate-900" x-text="timer.state.phase === 'countup' ? timer.formatTime(timer.state.sessionSeconds) : timer.formatTime(timer.remainingSeconds)"></p>
              <p class="mt-1 text-xs text-slate-500" x-text="timer.state.upcomingPhaseLabel"></p>
            </div>
          </div>
          <div class="flex w-full flex-col gap-4">
            <div class="flex items-center justify-between rounded-2xl border border-slate-200 bg-slate-50 px-4 py-2">
              <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Selected tags</span>
              <template x-if="timer.state.selectedTagIds.length === 0">
                <span class="text-xs text-slate-400">No tags yet</span>
              </template>
              <div class="flex flex-wrap justify-end gap-2">
                <template x-for="tagId in timer.state.selectedTagIds" :key="`hero-tag-${tagId}`">
                  <span
                    class="inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold"
                    :class="timer.state.tags.find(tag => tag.id === tagId)?.color ?? 'bg-slate-100 text-slate-600'"
                  >
                    <i class="fas fa-hashtag text-[10px]"></i>
                    <span x-text="timer.state.tags.find(tag => tag.id === tagId)?.label ?? tagId"></span>
                  </span>
                </template>
              </div>
            </div>
            <div class="flex items-center justify-between text-xs text-slate-500">
              <div class="flex items-center gap-2">
                <i class="fas fa-circle-play text-indigo-500"></i>
                <span x-text="`${timer.state.completedPomodorosToday} pomodoros`"></span>
              </div>
              <div class="flex items-center gap-2">
                <i class="fas fa-bell text-emerald-500"></i>
                <span x-text="timer.state.goalCelebration ? 'Goal nearly there!' : 'Keep building streaks'" class="font-medium"></span>
              </div>
            </div>
          </div>
        </div>
      </article>
    </div>
  </div>
</section>
