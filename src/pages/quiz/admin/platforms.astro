---
import Layout from "../../../layouts/Layout.astro";
import { actions } from "astro:actions";

const { data, error } = await Astro.callAction(actions.quiz.fetchPlatforms, { page: 1, pageSize: 10 });
if(error) console.log('error', error);
---
<Layout>
    <main class="bg-slate-50 min-h-screen">
        <section class="py-4" x-data=`$store.platforms.platformList = ${JSON.stringify(data?.items)}`>
            <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
                <div>
                    <h2 class="mt-3 text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Platforms</h2>
                </div>
                <div class="mt-10 mb-10">
                    <ul class="mt-3 space-y-2 text-xl text-black">
                        <template x-for="p in $store.platforms.platformList" :key="p.id">
                            <li class="flex items-center">
                                <span class="flex items-center gap-2">
                                    <i :class="p.icon ? `fas ${p.icon}` : 'fas fa-shapes'"></i>
                                    <span x-text="p.name"></span> - <span class="text-gray-600 text-sm italic" x-text="p.description"></span>
                                </span>
                            </li>
                        </template>
                    </ul>
                </div>
                <button 
                class="btn text-indigo-500 hover:text-indigo-700"
                :disabled="$store.platforms.page === 1"
                @click="await $store.platforms.getPlatforms(($store.platforms.page = $store.platforms.page - 1), 10)">Prev</button>
                <button 
                class="btn text-indigo-500 hover:text-indigo-700"
                @click="await $store.platforms.getPlatforms(($store.platforms.page = $store.platforms.page + 1), 10)">Next</button>
            </div>
        </section>
    </main>
</Layout>
