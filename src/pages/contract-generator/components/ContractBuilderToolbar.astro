---
import Button from '../../../components/Button.astro';
---
<section class="sticky top-[72px] z-30 border-b border-slate-200 bg-white/90 backdrop-blur">
  <div class="mx-auto flex flex-col gap-4 px-4 py-4 sm:px-6 lg:px-8 lg:flex-row lg:items-center lg:justify-between">
    <div class="flex flex-1 flex-col gap-3 lg:flex-row lg:items-center">
      <div class="lg:w-72">
        <label class="block text-xs font-semibold uppercase tracking-wide text-slate-500">
          Contract title
          <input
            type="text"
            class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-900 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"
            :value="$store.contract.builder.title"
            @input="$store.contract.updateTitle($event.target.value)"
          />
        </label>
      </div>
      <div class="grid flex-1 grid-cols-1 gap-3 sm:grid-cols-3">
        <label class="flex flex-col gap-1 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm">
          Template
          <select
            class="w-full appearance-none rounded-md border-none bg-transparent text-sm font-semibold text-slate-900 focus:outline-none"
            :value="$store.contract.builder.templateKey"
            @change="$store.contract.updateTemplate($event.target.value)"
          >
            <template x-for="template in $store.contract.templates" :key="template.key">
              <option :value="template.key" x-text="template.label"></option>
            </template>
          </select>
        </label>
        <label class="flex flex-col gap-1 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm">
          Status
          <select
            class="w-full appearance-none rounded-md border-none bg-transparent text-sm font-semibold text-slate-900 focus:outline-none"
            :value="$store.contract.builder.status"
            @change="$store.contract.updateStatus($event.target.value)"
          >
            <option value="draft">Draft</option>
            <option value="published">Published</option>
          </select>
        </label>
        <label class="flex flex-col gap-1 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm">
          AI tone
          <select
            class="w-full appearance-none rounded-md border-none bg-transparent text-sm font-semibold text-slate-900 focus:outline-none"
            :value="$store.contract.builder.aiTone"
            @change="$store.contract.builder.aiTone = $event.target.value"
          >
            <option value="formal">Formal</option>
            <option value="friendly">Friendly</option>
            <option value="direct">Direct</option>
            <option value="concise">Concise</option>
          </select>
        </label>
      </div>
    </div>
    <div class="flex flex-wrap items-center gap-3">
      <div class="text-xs text-slate-500" x-text="$store.contract.builder.autosaveLabel ?? ''"></div>
      <Button
        type="button"
        variant="ghost"
        class="min-w-[110px]"
        @click.prevent="$store.contract.saveNow()"
      >
        <i class="fas fa-floppy-disk text-xs"></i>
        Save now
      </Button>
      <Button
        type="button"
        variant="ghost"
        class="min-w-[150px]"
        @click.prevent="$store.contract.runClauseAI('services', 'draft')"
        :disabled="$store.contract.builder.aiBusy"
      >
        <i class="fas fa-sparkles text-xs"></i>
        AI draft services
      </Button>
      <div class="hidden h-6 w-px bg-slate-200 md:block"></div>
      <div class="flex items-center gap-2">
        <Button
          type="button"
          variant="ghost"
          class="min-w-[110px]"
          @click.prevent="$store.contract.export('pdf')"
        >
          <i class="fas fa-file-arrow-down text-xs"></i>
          Export
        </Button>
        <Button
          type="button"
          variant="ghost"
          class="min-w-[110px]"
          @click.prevent="$store.contract.addVersion()"
        >
          <i class="fas fa-clock-rotate-left text-xs"></i>
          Save version
        </Button>
      </div>
      <Button
        type="button"
        @click.prevent="$store.contract.publishCurrent()"
        :disabled="!$store.contract.builder.id"
      >
        <i class="fas fa-earth-americas text-xs"></i>
        Publish
      </Button>
    </div>
  </div>
</section>
