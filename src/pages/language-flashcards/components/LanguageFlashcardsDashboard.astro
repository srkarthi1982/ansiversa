<section id="langcards-dashboard" class="bg-slate-50 py-16">
  <div class="mx-auto max-w-6xl space-y-12 px-4 sm:px-6 lg:px-8">
    <header class="space-y-3 text-center lg:text-left">
      <p class="inline-flex items-center gap-2 rounded-full bg-indigo-100 px-4 py-1.5 text-sm font-semibold text-indigo-700">
        <i class="fas fa-layer-group text-xs"></i>
        Today&apos;s workspace
      </p>
      <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Review queue, quick add, and deck controls</h2>
      <p class="text-base text-slate-600 sm:text-lg">
        Grade cards with SM-2, queue pronunciations, and keep decks in sync with auto-generated suggestions.
      </p>
    </header>
    <div class="grid gap-8 lg:grid-cols-[1fr_1.2fr_0.9fr]">
      <aside class="space-y-6">
        <div class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
          <header class="flex items-center justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Active deck</p>
              <p class="mt-1 text-lg font-semibold text-slate-900" x-text="app.activeDeck?.name ?? 'Select a deck'"></p>
            </div>
            <button
              type="button"
              class="inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-indigo-300 hover:text-indigo-600"
              @click="app.toggleDeckPinned(app.state.activeDeckId)"
              :disabled="!app.activeDeck"
            >
              <i class="fas" :class="app.activeDeck?.pinned ? 'fa-thumbtack' : 'fa-thumbtack-slash'"></i>
              <span x-text="app.activeDeck?.pinned ? 'Pinned' : 'Pin deck'"></span>
            </button>
          </header>
          <p class="mt-4 text-sm text-slate-500" x-text="app.activeDeck?.description ?? 'Choose a deck from the library to begin.'"></p>
          <dl class="mt-6 grid gap-4 text-left sm:grid-cols-2">
            <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4">
              <dt class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Tags</dt>
              <dd class="mt-2 flex flex-wrap gap-2 text-xs font-semibold text-indigo-600">
                <template x-for="tag in app.activeDeck?.tags ?? []" :key="tag">
                  <span class="inline-flex items-center gap-1 rounded-full bg-indigo-100 px-3 py-1"><i class="fas fa-hashtag text-[10px]"></i> <span x-text="tag"></span></span>
                </template>
              </dd>
            </div>
            <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4">
              <dt class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Plan</dt>
              <dd class="mt-2 text-base font-semibold text-slate-900" x-text="app.activeDeck?.plan === 'pro' ? 'Pro features' : 'Free tier'"></dd>
          <p class="text-xs text-slate-500">Accuracy <span x-text="(app.activeDeck?.accuracy ?? 0) + '%'"></span> · Streak <span x-text="app.activeDeck?.streakDays ?? 0"></span> days</p>
            </div>
          </dl>
          <div class="mt-6 space-y-3 text-sm text-slate-600">
            <button
              type="button"
              class="inline-flex w-full items-center justify-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-2 font-semibold text-slate-700 transition hover:border-indigo-300 hover:bg-white hover:text-indigo-600"
              @click.prevent="app.prepareReview('due')"
            >
              <i class="fas fa-clock text-xs"></i>
              Review due cards
            </button>
            <button
              type="button"
              class="inline-flex w-full items-center justify-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-2 font-semibold text-slate-700 transition hover:border-emerald-300 hover:bg-white hover:text-emerald-600"
              @click.prevent="app.prepareReview('new')"
            >
              <i class="fas fa-sun text-xs"></i>
              Introduce new cards
            </button>
            <button
              type="button"
              class="inline-flex w-full items-center justify-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-2 font-semibold text-slate-700 transition hover:border-amber-300 hover:bg-white hover:text-amber-600"
              @click.prevent="app.refreshAnalytics()"
            >
              <i class="fas fa-chart-line text-xs"></i>
              Refresh analytics
            </button>
          </div>
        </div>
        <div class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
          <h3 class="text-base font-semibold text-slate-900">Quick add</h3>
          <p class="mt-2 text-xs text-slate-500">Add a new bilingual word or phrase to the active deck.</p>
          <div class="mt-4 space-y-3">
            <label class="block">
              <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Answer (target language)</span>
              <input
                type="text"
                placeholder="biblioteca"
                class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
                x-model="app.state.quickAdd.translation"
              />
            </label>
            <label class="block">
              <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Prompt (base language)</span>
              <input
                type="text"
                placeholder="library"
                class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
                x-model="app.state.quickAdd.term"
              />
            </label>
            <label class="block">
              <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Tag</span>
              <input
                type="text"
                placeholder="Travel"
                class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
                x-model="app.state.quickAdd.tag"
              />
            </label>
            <button
              type="button"
              class="inline-flex w-full items-center justify-center gap-2 rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm shadow-indigo-500/30 transition hover:bg-indigo-500"
              @click.prevent="app.addQuickCard()"
            >
              <i class="fas fa-plus text-xs"></i>
              Add to new queue
            </button>
          </div>
        </div>
      </aside>
      <section class="rounded-3xl border border-slate-200 bg-white p-6 shadow-lg shadow-slate-200/60">
        <header class="flex flex-wrap items-center justify-between gap-3">
          <div>
            <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Review player</p>
            <h3 class="text-lg font-semibold text-slate-900">
              <span x-text="app.state.review.queueType === 'due' ? 'Due cards' : 'New cards'"></span>
              <span class="text-slate-400">·</span>
              <span class="capitalize" x-text="app.state.review.mode"></span>
            </h3>
          </div>
          <div class="flex flex-wrap gap-2">
            <template x-for="mode in app.state.reviewModes" :key="mode.id">
              <button
                type="button"
                class="inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-semibold transition"
                :class="app.state.review.mode === mode.id ? 'border-indigo-500 bg-indigo-500/10 text-indigo-600' : 'border-slate-200 bg-slate-50 text-slate-600 hover:border-indigo-300 hover:text-indigo-500'"
                @click.prevent="app.setReviewMode(mode.id)"
              >
                <i class="fas" :class="mode.icon"></i>
                <span x-text="mode.label"></span>
              </button>
            </template>
          </div>
        </header>
        <div class="mt-6 grid gap-6 lg:grid-cols-[1fr_0.9fr]">
          <article class="flex flex-col gap-4 rounded-2xl border border-slate-200 bg-slate-50 p-5">
            <template x-if="app.state.review.queue.length">
              <div>
                <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Prompt</p>
                <p class="mt-2 text-2xl font-semibold text-slate-900" x-text="app.state.review.queue[app.state.review.activeIndex]?.prompt"></p>
                <p class="mt-2 text-xs text-slate-500" x-show="app.state.review.queue[app.state.review.activeIndex]?.transliteration">
                  Transliteration:
                  <span class="font-semibold text-slate-700" x-text="app.state.review.queue[app.state.review.activeIndex]?.transliteration"></span>
                </p>
                <p class="mt-2 text-xs text-slate-500" x-show="app.state.review.queue[app.state.review.activeIndex]?.ipa">
                  IPA:
                  <span class="font-semibold text-slate-700" x-text="app.state.review.queue[app.state.review.activeIndex]?.ipa"></span>
                </p>
                <p class="mt-3 rounded-xl bg-white px-3 py-2 text-xs text-slate-600" x-show="app.state.review.queue[app.state.review.activeIndex]?.hint">
                  Hint: <span x-text="app.state.review.queue[app.state.review.activeIndex]?.hint"></span>
                </p>
                <div class="mt-4 flex flex-wrap gap-3">
                  <button
                    type="button"
                    class="inline-flex items-center gap-2 rounded-full bg-indigo-600 px-4 py-2 text-xs font-semibold text-white shadow-sm shadow-indigo-500/30 hover:bg-indigo-500"
                    @click.prevent="app.revealAnswer()"
                    :disabled="app.state.review.showAnswer"
                  >
                    <i class="fas fa-eye text-[10px]"></i>
                    Reveal answer
                  </button>
                  <button
                    type="button"
                    class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-4 py-2 text-xs font-semibold text-slate-600 transition hover:border-indigo-300 hover:text-indigo-500"
                    @click.prevent="app.skipCard()"
                  >
                    <i class="fas fa-forward text-[10px]"></i>
                    Skip
                  </button>
                </div>
                <div class="mt-6 space-y-3" x-show="app.state.review.showAnswer">
                  <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Answer</p>
                  <p class="text-xl font-semibold text-emerald-600" x-text="app.state.review.queue[app.state.review.activeIndex]?.answer"></p>
                  <p class="text-xs text-slate-500" x-show="app.state.review.queue[app.state.review.activeIndex]?.exampleBase">
                    <span class="font-semibold">Example:</span>
                    <span x-text="app.state.review.queue[app.state.review.activeIndex]?.exampleBase"></span>
                  </p>
                  <p class="text-xs text-slate-500" x-show="app.state.review.queue[app.state.review.activeIndex]?.exampleTarget">
                    <span class="font-semibold">Target:</span>
                    <span x-text="app.state.review.queue[app.state.review.activeIndex]?.exampleTarget"></span>
                  </p>
                  <div class="rounded-2xl border border-dashed border-slate-300 bg-white px-4 py-3">
                    <p class="text-[11px] font-semibold uppercase tracking-[0.2em] text-slate-500">Grade (0–5)</p>
                    <div class="mt-2 flex flex-wrap gap-2">
                      <template x-for="grade in [0,1,2,3,4,5]" :key="grade">
                        <button
                          type="button"
                          class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 text-sm font-semibold transition hover:border-indigo-400 hover:text-indigo-600"
                          @click.prevent="app.gradeCurrent(grade)"
                        >
                          <span x-text="grade"></span>
                        </button>
                      </template>
                    </div>
                  </div>
                </div>
              </div>
            </template>
            <template x-if="!app.state.review.queue.length">
              <div class="flex h-full flex-col items-center justify-center gap-2 text-center text-sm text-slate-500">
                <i class="fas fa-inbox text-xl"></i>
                <p>No cards queued. Generate new suggestions or import a deck.</p>
              </div>
            </template>
          </article>
          <aside class="space-y-4">
            <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4">
              <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Session status</p>
              <p class="mt-2 text-lg font-semibold text-slate-900">
                <span x-text="app.state.review.status === 'done' ? 'Completed' : (app.state.review.activeIndex + 1) + '/' + app.state.review.queue.length"></span>
              </p>
              <p class="text-xs text-slate-500">Mode: <span x-text="app.state.review.mode"></span></p>
              <p class="text-xs text-slate-500">Queue: <span x-text="app.state.review.queueType === 'due' ? 'Due cards' : 'New cards'"></span></p>
              <template x-if="app.state.review.mode === 'speak'">
                <div class="mt-4 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs text-slate-600">
                  <p class="font-semibold text-slate-700">Similarity score</p>
                  <p class="text-lg font-bold text-indigo-600" x-text="app.state.review.similarityScore ? app.state.review.similarityScore + '%' : '—'"></p>
                  <button
                    type="button"
                    class="mt-2 inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1 text-[11px] font-semibold text-slate-600 hover:border-indigo-300 hover:text-indigo-500"
                    @click.prevent="app.simulateSimilarity()"
                  >
                    <i class="fas fa-microphone-lines text-[10px]"></i>
                    Simulate recording
                  </button>
                </div>
              </template>
              <div class="mt-4 space-y-2 text-xs text-slate-500">
                <template x-for="entry in app.state.review.history.slice().reverse()" :key="entry.reviewedAt">
                  <p class="rounded-xl border border-slate-200 bg-white px-3 py-2">
                    <span class="font-semibold text-slate-700">Grade <span x-text="entry.grade"></span></span>
                    <span class="ml-2">→ Next in <span x-text="entry.dueInDays"></span> days (ease <span x-text="entry.ease.toFixed(2)"></span>)</span>
                  </p>
                </template>
                <p x-show="!app.state.review.history.length" class="rounded-xl border border-dashed border-slate-300 bg-white px-3 py-2">No reviews graded yet.</p>
              </div>
            </div>
            <div class="rounded-2xl border border-slate-200 bg-white p-4 text-xs text-slate-500">
              <p class="font-semibold text-slate-700">Keyboard shortcuts</p>
              <ul class="mt-2 space-y-1">
                <li>1–6: grade card · Space: reveal answer · Shift+S: skip card</li>
                <li>Alt+G: open generator · Alt+A: analytics snapshot</li>
              </ul>
            </div>
          </aside>
        </div>
      </section>
      <section class="space-y-6 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
        <header class="flex items-center justify-between">
          <div>
            <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Deck selector</p>
            <h3 class="text-lg font-semibold text-slate-900">Pinned decks and filters</h3>
          </div>
          <button
            type="button"
            class="inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-indigo-300 hover:text-indigo-500"
            @click.prevent="app.clearFilters()"
          >
            <i class="fas fa-rotate-left text-[10px]"></i>
            Reset filters
          </button>
        </header>
        <div class="grid gap-3 text-sm text-slate-600 sm:grid-cols-2">
          <label class="flex flex-col gap-2">
            <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Search</span>
            <input
              type="search"
              placeholder="Spanish A1"
              class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-2 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
              x-model="app.state.deckFilter.search"
            />
          </label>
          <label class="flex flex-col gap-2">
            <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Plan</span>
            <select
              class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-2 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
              x-model="app.state.deckFilter.plan"
            >
              <option value="all">All</option>
              <option value="free">Free</option>
              <option value="pro">Pro</option>
            </select>
          </label>
          <label class="flex flex-col gap-2">
            <span class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">Tag</span>
            <input
              type="text"
              placeholder="Travel"
              class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-2 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
              x-model="app.state.deckFilter.tag"
            />
          </label>
        </div>
        <div class="space-y-4">
          <template x-for="deck in app.filteredDecks" :key="deck.id">
            <article
              class="group flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm transition hover:border-indigo-300 hover:shadow-lg"
            >
              <header class="flex items-center justify-between">
                <div>
                  <p class="text-sm font-semibold text-slate-900" x-text="deck.name"></p>
                  <p class="text-xs text-slate-500" x-text="deck.pairLabel"></p>
                </div>
                <button
                  type="button"
                  class="inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-semibold transition"
                  :class="deck.id === app.state.activeDeckId ? 'border-indigo-500 bg-indigo-500/10 text-indigo-600' : 'border-slate-200 bg-slate-50 text-slate-600 hover:border-indigo-300 hover:text-indigo-500'"
                  @click.prevent="app.setActiveDeck(deck.id)"
                >
                  <i class="fas" :class="deck.id === app.state.activeDeckId ? 'fa-circle-check' : 'fa-circle'"></i>
                  Set active
                </button>
              </header>
              <p class="text-xs text-slate-500" x-text="deck.description"></p>
              <div class="flex flex-wrap gap-2 text-[11px] text-slate-500">
                <span class="inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-1"><i class="fas fa-fire text-[9px] text-amber-500"></i> Due <span class="font-semibold" x-text="deck.dueToday"></span></span>
                <span class="inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-1"><i class="fas fa-sun text-[9px] text-emerald-500"></i> New <span class="font-semibold" x-text="deck.newToday"></span></span>
                <span class="inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-1"><i class="fas fa-bolt text-[9px] text-indigo-500"></i> Accuracy <span class="font-semibold" x-text="deck.accuracy + '%'"></span></span>
              </div>
            </article>
          </template>
          <p x-show="!app.filteredDecks.length" class="rounded-2xl border border-dashed border-slate-300 bg-slate-50 p-4 text-sm text-slate-500">
            No decks match your filters. Try clearing search keywords or selecting a different plan.
          </p>
        </div>
      </section>
    </div>
  </div>
</section>
