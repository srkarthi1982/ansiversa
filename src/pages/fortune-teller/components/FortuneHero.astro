---
import Button from '../../../components/Button.astro';
---
<section
  class="relative overflow-hidden bg-gradient-to-br from-purple-700 via-indigo-600 to-sky-500 py-16 text-white"
  x-data="() => ({ fortune: $store.fortuneOracle })"
>
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.18),_rgba(12,20,33,0.65))]"></div>
  <div class="relative mx-auto flex max-w-6xl flex-col gap-12 px-4 sm:px-6 lg:flex-row lg:items-center lg:px-8">
    <div class="space-y-6 lg:w-7/12">
      <span class="inline-flex items-center gap-2 rounded-full bg-white/15 px-4 py-1 text-xs font-semibold uppercase tracking-[0.35em]">
        <i class="fas fa-crystal-ball text-[11px]"></i>
        Fortune Teller
      </span>
      <h1 class="text-4xl font-bold tracking-tight sm:text-5xl lg:text-6xl">
        Entertainment-first fortunes with seeded magic and safety rails
      </h1>
      <p class="text-base text-white/80 sm:text-lg">
        Draw playful tarot-inspired cards, spin a yes/no oracle, or explore zodiac and numerology riffs — all powered by
        seeded randomness, opt-in personalization, and strong disclaimers. Fortune Teller keeps things light while giving your
        community a ritual worth revisiting.
      </p>
      <div class="flex flex-wrap gap-3">
        <Button href="#fortune-preview" variant="secondary">
          <i class="fas fa-wand-magic-sparkles text-xs"></i>
          See live preview
        </Button>
        <Button href="#fortune-personalize" variant="outline">
          <i class="fas fa-sliders text-xs"></i>
          Configure personalization
        </Button>
        <Button
          type="button"
          variant="ghost"
          class="text-white/80 hover:text-white"
          @click.prevent="fortune.rerollDaily('Wanted more detail')"
        >
          <i class="fas fa-rotate text-xs"></i>
          Reroll daily sample
        </Button>
      </div>
      <div class="space-y-2 text-xs text-white/70">
        <template x-for="line in fortune.state.disclaimers" :key="line">
          <p class="flex items-center gap-2">
            <i class="fas fa-shield-heart text-[10px]"></i>
            <span x-text="line"></span>
          </p>
        </template>
      </div>
      <p class="text-xs text-white/70" x-show="fortune.state.lastAction" x-cloak>
        <i class="fas fa-broadcast-tower mr-2 text-[10px]"></i>
        <span x-text="fortune.state.lastAction"></span>
      </p>
    </div>
    <div class="relative w-full lg:w-5/12">
      <div class="absolute inset-0 translate-x-6 translate-y-6 rounded-3xl bg-indigo-900/40 opacity-40 blur-2xl"></div>
      <div class="relative space-y-6 rounded-3xl border border-white/20 bg-white/10 p-6 backdrop-blur">
        <header class="flex items-start justify-between">
          <div>
            <p class="text-sm font-semibold uppercase tracking-[0.3em] text-white/70">Daily fortune</p>
            <p class="text-xs text-white/60">
              Theme <span class="font-semibold" x-text="fortune.state.activeTheme"></span> · Intent
              <span class="font-semibold" x-text="fortune.state.activeIntent"></span>
            </p>
          </div>
          <span class="inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white/80">
            <i class="fas fa-seedling text-[10px]"></i>
            <span x-text="fortune.state.daily?.seed ?? '—'"></span>
          </span>
        </header>
        <article class="space-y-4 rounded-2xl border border-white/15 bg-white/10 p-5">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-xs uppercase tracking-[0.3em] text-white/60">Card</p>
              <p class="mt-1 text-xl font-semibold" x-text="fortune.state.daily?.cardTitle ?? 'Drawing…'"></p>
            </div>
            <div class="text-right text-xs text-white/60">
              <p class="font-semibold" x-text="fortune.state.daily?.orientation ?? ''"></p>
              <p>Lucky focus</p>
              <p class="font-semibold text-white" x-text="fortune.state.daily?.luckyFocus ?? '—'"></p>
            </div>
          </div>
          <p class="text-sm text-white/80" x-text="fortune.state.daily?.summary ?? ''"></p>
          <div class="rounded-2xl border border-white/20 bg-white/5 p-4 text-sm text-white/80">
            <p class="text-xs uppercase tracking-[0.3em] text-white/60">Tiny action</p>
            <p class="mt-2 font-medium" x-text="fortune.state.daily?.action ?? ''"></p>
          </div>
          <p class="text-xs uppercase tracking-[0.3em] text-white/60">Keywords</p>
          <div class="flex flex-wrap gap-2 text-xs text-white/70">
            <template x-for="keyword in fortune.state.daily?.keywords ?? []" :key="keyword">
              <span class="rounded-full border border-white/20 px-3 py-1" x-text="keyword"></span>
            </template>
          </div>
          <p class="text-xs text-white/70">
            <span class="font-semibold">Affirmation:</span>
            <span x-text="fortune.state.daily?.affirmation ?? ''"></span>
          </p>
        </article>
        <footer class="space-y-3 text-xs text-white/70">
          <div class="flex items-center justify-between">
            <span>Rerolls remaining</span>
            <span class="font-semibold" x-text="Math.max(fortune.state.dailyRerollLimit - fortune.state.dailyRerollsUsed, 0)"></span>
          </div>
          <div class="flex items-center justify-between">
            <span>Cooldown (Yes/No)</span>
            <span class="font-semibold" x-text="fortune.state.yesno.cooldownRemaining ? `${fortune.state.yesno.cooldownRemaining}s` : 'Ready'"></span>
          </div>
          <div class="flex items-center justify-between">
            <span>Timezone</span>
            <span class="font-semibold" x-text="fortune.state.timezone"></span>
          </div>
        </footer>
      </div>
    </div>
  </div>
</section>
