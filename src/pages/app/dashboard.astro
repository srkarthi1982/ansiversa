---
import Layout from "../../layouts/Layout.astro";
import Button from "../../components/Button.astro";

const displayName = Astro.locals.user?.username
  ? Astro.locals.user?.username?.toUpperCase()
  : "CREATOR";
---
<Layout>
  <main class="bg-slate-50 min-h-screen">
    <section class="border-b border-slate-200 bg-white/80 backdrop-blur">
      <div class="mx-auto max-w-6xl px-4 py-14 sm:px-6 lg:px-8">
        <div class="flex flex-col gap-8 lg:flex-row lg:items-center lg:justify-between">
          <div>
            <p class="text-sm font-semibold uppercase tracking-[0.2em] text-indigo-500">Team Overview</p>
            <h1 class="mt-3 text-4xl font-bold tracking-tight text-slate-900 sm:text-5xl">
              Welcome back, {displayName}
            </h1>
            <p class="mt-4 max-w-2xl text-base text-slate-600">
              Track product momentum, monitor engagement, and keep your projects aligned. Everything you need to build at speed—right here.
            </p>
            <div class="mt-6 flex flex-wrap gap-3">
              <Button href="/app/settings" size="sm">
                <i class="fas fa-sliders-h text-sm"></i>
                Customize workspace
              </Button>
              <Button href="/quiz/admin/platform" variant="outline" size="sm">
                <i class="fas fa-plus text-sm"></i>
                New platform
              </Button>
            </div>
          </div>
          <div class="grid w-full max-w-lg grid-cols-2 gap-4 rounded-2xl border border-slate-200 bg-slate-900/90 p-6 text-slate-50 shadow-xl backdrop-blur">
            <div>
              <p class="text-sm uppercase tracking-wide text-slate-400">Active Users</p>
              <p class="mt-2 text-3xl font-bold">18.4k</p>
              <p class="mt-1 text-xs text-slate-400">+12% vs last month</p>
            </div>
            <div>
              <p class="text-sm uppercase tracking-wide text-slate-400">Response Rate</p>
              <p class="mt-2 text-3xl font-bold">94%</p>
              <p class="mt-1 text-xs text-slate-400">Best streak in 6 months</p>
            </div>
            <div class="col-span-2">
              <div class="flex items-center justify-between text-xs text-slate-300">
                <span>Roadmap completion</span>
                <span>68%</span>
              </div>
              <div class="mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-700">
                <div class="h-full w-[68%] rounded-full bg-indigo-400"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="mx-auto max-w-6xl px-4 py-12 sm:px-6 lg:px-8">
      <div class="grid gap-6 md:grid-cols-3">
        {[
          { label: "New signups", value: "1,204", change: "+18.3%", icon: "fa-user-plus", tone: "text-emerald-600 bg-emerald-50" },
          { label: "Avg. session time", value: "6m 22s", change: "+2.1%", icon: "fa-clock", tone: "text-sky-600 bg-sky-50" },
          { label: "Feedback score", value: "4.7 / 5", change: "+0.4", icon: "fa-star", tone: "text-amber-600 bg-amber-50" },
        ].map((item) => (
          <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-[0_16px_30px_-20px_rgba(79,70,229,0.35)] transition hover:-translate-y-1 hover:shadow-[0_26px_48px_-24px_rgba(79,70,229,0.55)]">
            <div class="flex items-center justify-between">
              <p class="text-xs font-semibold uppercase tracking-wider text-slate-500">{item.label}</p>
              <span class={`inline-flex h-9 w-9 items-center justify-center rounded-xl ${item.tone}`}>
                <i class={`fas ${item.icon}`}></i>
              </span>
            </div>
            <p class="mt-4 text-3xl font-bold text-slate-900">{item.value}</p>
            <p class={`mt-2 text-xs font-semibold ${item.change.trim()?.startsWith('-') ? 'text-rose-600' : 'text-emerald-600'}`}>
              {item.change} last 30 days
            </p>
          </div>
        ))}
      </div>
    </section>

    <section class="mx-auto max-w-6xl px-4 pb-16 sm:px-6 lg:px-8">
      <div class="grid gap-6 lg:grid-cols-3">
        <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm lg:col-span-2">
          <div class="flex items-center justify-between">
            <div>
              <h2 class="text-lg font-semibold text-slate-900">Recent Highlights</h2>
              <p class="text-xs text-slate-500">Momentum from the last 7 days</p>
            </div>
            <Button href="/quiz/admin/subjects" size="xs" variant="outline">
              View all updates
            </Button>
          </div>
          <ol class="mt-8 space-y-6">
            {[
              { title: "Onboarded 3 enterprise clients", detail: "Adarma, Flarion, and Northern Labs rolled out the new adaptive assessments.", timestamp: "Today • 09:32" },
              { title: "Released adaptive scoring", detail: "Beta testers reported a 34% uplift in completion confidence.", timestamp: "Yesterday • 16:18" },
              { title: "Cross-team planning session", detail: "Roadmap aligned for Q4 deliverables across content + platform teams.", timestamp: "Monday • 11:05" },
            ].map((highlight) => (
              <li class="flex items-start gap-4 rounded-xl border border-slate-100 bg-slate-50 px-4 py-3">
                <span class="mt-1 flex h-2.5 w-2.5 flex-shrink-0 rounded-full bg-indigo-500"></span>
                <div>
                  <p class="text-sm font-semibold text-slate-900">{highlight.title}</p>
                  <p class="mt-1 text-xs text-slate-600">{highlight.detail}</p>
                  <p class="mt-2 text-[11px] font-semibold uppercase tracking-wide text-slate-400">{highlight.timestamp}</p>
                </div>
              </li>
            ))}
          </ol>
        </div>
        <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
          <h2 class="text-lg font-semibold text-slate-900">Team load balance</h2>
          <p class="mt-1 text-xs text-slate-500">Where attention is flowing this sprint</p>
          <div class="mt-6 space-y-5">
            {[
              { label: "Platform engineering", percent: 72, tone: "bg-indigo-500" },
              { label: "Content curation", percent: 54, tone: "bg-emerald-500" },
              { label: "Review ops", percent: 38, tone: "bg-sky-500" },
              { label: "Support and success", percent: 22, tone: "bg-amber-500" },
            ].map((team) => (
              <div>
                <div class="flex items-center justify-between text-xs font-semibold text-slate-500">
                  <span>{team.label}</span>
                  <span>{team.percent}%</span>
                </div>
                <div class="mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-100">
                  <div class={`h-full ${team.tone}`} style={`width: ${team.percent}%`}></div>
                </div>
              </div>
            ))}
          </div>
          <div class="mt-8 rounded-xl border border-indigo-100 bg-indigo-50 p-4 text-xs text-indigo-700">
            <p class="font-semibold">Heads up</p>
            <p class="mt-1">
              Demand for review operations is trending upward. Consider reallocating 10% capacity from content once the current sprint closes.
            </p>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>
