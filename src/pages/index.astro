---
import Layout from "../layouts/Layout.astro";

const mission =
  "Ansiversa is an AI-powered universe of 100 web-based mini-apps engineered for learning, creativity, productivity, and everyday life — all unified under one subscription.";

const pageFiles = Object.keys(
  import.meta.glob("../pages/**/*.{astro,md,mdx}", { eager: false })
);

const availableRoutes = new Set(
  pageFiles.map((filePath) => {
    const routePath = filePath
      .replace("../pages", "")
      .replace(/\/index\.(astro|mdx?|md)$/, "/")
      .replace(/\.(astro|mdx?|md)$/, "");

    if (!routePath || routePath === "/") {
      return "/";
    }

    return routePath.endsWith("/") ? routePath.slice(0, -1) : routePath;
  })
);

const normalizeRoute = (href: string | undefined) => {
  if (!href) return undefined;
  const withLeadingSlash = href.startsWith("/") ? href : `/${href}`;
  if (withLeadingSlash === "/") return "/";
  return withLeadingSlash.replace(/\/+$/, "");
};

const resolveMiniAppHref = (href?: string | undefined) => {
  const normalized = normalizeRoute(href);
  if (!normalized) return undefined;

  const candidateRoutes: string[] = [];

  const addCandidate = (value: string | undefined) => {
    const candidate = normalizeRoute(value);
    if (!candidate) return;
    if (!candidateRoutes.includes(candidate)) {
      candidateRoutes.push(candidate);
    }
  };

  addCandidate(normalized);

  for (const candidate of [...candidateRoutes]) {
    if (candidate !== "/") {
      addCandidate(`${candidate}/pages`);
    }
  }

  for (const candidate of candidateRoutes) {
    if (availableRoutes.has(candidate)) {
      return candidate;
    }
  }

  return candidateRoutes[0];
};

const miniAppCategories = [
  {
    name: "Learning & Knowledge",
    blurb: "Adaptive study tools for students, teachers, and lifelong learners.",
    accent: "from-indigo-500 via-sky-500 to-purple-500",
    apps: [
      { name: "Quiz", href: "/quiz" },
      { name: "FlashNote", href: "/flashnote" },
      { name: "Research Assistant", href: null },
      { name: "AI Notes Summarizer", href: null },
      { name: "Concept Explainer", href: null },
      { name: "Study Planner", href: null },
      { name: "Course Tracker", href: 'course-tracker' },
      { name: "Dictionary+", href: null },
      { name: "Knowledge Duel", href: null },
      { name: "Fact Generator", href: null },
      { name: "Formula Finder", href: null },
      { name: "Language Flashcards", href: null },
      { name: "Exam Simulator", href: null },
      { name: "EduPrompt", href: null },
      { name: "Lesson Builder", href: 'lesson-builder' },
      { name: "Study Timer", href: null },
      { name: "Memory Trainer", href: null },
      { name: "Daily Word Challenge", href: null },
      { name: "Smart Textbook Scanner", href: null },
      { name: "Homework Helper", href: null },
    ],
  },
  {
    name: "Career & Professional",
    blurb: "Polish portfolios, communications, and meetings in minutes.",
    accent: "from-purple-500 via-indigo-500 to-sky-500",
    apps: [
      { name: "Resume Builder", href: "/resume-builder" },
      { name: "Cover Letter Writer", href: '/cover-letter-writer' },
      { name: "Visiting Card Maker", href: '/visiting-card-maker' },
      { name: "Interview Coach", href: null },
      { name: "Job Description Analyzer", href: "/job-analyzer" },
      { name: "Portfolio Creator", href: "/portfolio-creator" },
      { name: "Meeting Minutes AI", href: "/meeting-minutes-ai" },
      { name: "Email Polisher", href: "/email-polisher" },
      { name: "Proposal Writer", href: "/proposal-writer" },
      { name: "Invoice & Receipt Maker", href: "/invoice-and-receipt-maker" },
      { name: "Contract Generator", href: "/contract-generator" },
      { name: "Presentation Designer", href: null },
      { name: "Career Planner", href: "/career-planner" },
      { name: "LinkedIn Bio Optimizer", href: null },
      { name: "Client Feedback Analyzer", href: null },
    ],
  },
  {
    name: "Writing & Creativity",
    blurb: "Unlock storytelling, marketing copy, and artistic expression.",
    accent: "from-sky-500 via-purple-500 to-indigo-500",
    apps: [
      { name: "StoryCrafter", href: null },
      { name: "Poem Studio", href: null },
      { name: "Song Lyric Maker", href: null },
      { name: "Ad Copy Assistant", href: null },
      { name: "Book Summary Generator", href: null },
      { name: "Blog Writer", href: "/blog-writer" },
      { name: "Social Caption Generator", href: 'social-caption-generator' },
      { name: "Script Formatter", href: null },
      { name: "Creative Title Maker", href: null },
      { name: "Quote Forge", href: null },
      { name: "AI Meme Creator", href: null },
      { name: "Prompt Builder", href: "/prompt-builder" },
      { name: "Speech Writer", href: null },
      { name: "Novel Outliner", href: null },
      { name: "Comic Storyboarder", href: null },
      { name: "Fanfic Generator", href: null },
      { name: "Email Newsletter Writer", href: null },
      { name: "AI Translator & Tone Fixer", href: null },
      { name: "Rephrase & Paraphraser", href: null },
      { name: "Grammar Fixer", href: null },
    ],
  },
  {
    name: "Utility & Productivity",
    blurb: "Snappy helpers that automate workflows for makers and teams.",
    accent: "from-indigo-500 via-slate-500 to-purple-500",
    apps: [
      { name: "Snippet Generator", href: null },
      { name: "File Converter", href: null },
      { name: "Image Background Remover", href: null },
      { name: "Unit & Currency Converter", href: null },
      { name: "Price Checker", href: null },
      { name: "QR Code Creator", href: null },
      { name: "Clipboard Manager", href: null },
      { name: "File Compressor", href: null },
      { name: "Text-to-Speech Converter", href: null },
      { name: "Speech-to-Text Converter", href: null },
      { name: "Screenshot Editor", href: null },
      { name: "Color Palette Generator", href: null },
      { name: "Password Generator", href:null },
      { name: "API Tester", href: null },
      { name: "JSON Formatter", href: null },
      { name: "Markdown Editor", href: null },
      { name: "Time Zone Scheduler", href: null },
      { name: "Browser PDF Reader", href: null },
      { name: "Clipboard Translator", href: null},
      { name: "Quick Notepad", href: null },
    ],
  },
  {
    name: "Lifestyle & Well-Being",
    blurb: "Plan habits, health, travel, and personal growth with gentle insights.",
    accent: "from-emerald-500 via-sky-500 to-indigo-500",
    apps: [
      { name: "Wellness & Goal Planner", href: null },
      { name: "Event Planner", href: null },
      { name: "Meal Planner", href: null },
      { name: "Fitness Tracker", href: null },
      { name: "Mood Journal", href: null },
      { name: "Meditation Script Maker", href: null },
      { name: "Sleep Routine Designer", href: null },
      { name: "Affirmation Generator", href: null },
      { name: "Expense Tracker", href: null},
      { name: "Shopping List AI", href: null },
      { name: "Travel Itinerary Builder", href: null },
      { name: "Recipe Generator", href: null },
      { name: "Pet Care Planner", href: null },
      { name: "Language Learning Buddy", href: null },
      { name: "Eco Habit Tracker", href: null },
    ],
  },
  {
    name: "Fun & Engagement",
    blurb: "Bring playful experiences to every break, classroom, or meetup.",
    accent: "from-purple-500 via-fuchsia-500 to-sky-500",
    apps: [
      { name: "Trivia Arena", href: null },
      { name: "Riddle Maker", href: null },
      { name: "Puzzle Zone", href: null },
      { name: "Would You Rather", href: null },
      { name: "Guess the Emoji", href: null },
      { name: "AI Character Chat", href: null},
      { name: "Personality Quiz", href: null },
      { name: "Fortune Teller", href: null},
      { name: "Horoscope AI", href: null },
      { name: "Daily Challenge", href: null },
    ],
  },
];

const categorizedMiniApps = miniAppCategories
  .map((category) => {
    const apps = category.apps
      .map((app) => {
        const resolvedHref = resolveMiniAppHref(app.href);

        return {
          ...app,
          href: resolvedHref,
          available: Boolean(resolvedHref),
        };
      })
      .filter((app) => app.available);

    return {
      ...category,
      apps,
    };
  })
  .filter((category) => category.apps.length > 0);

const plans = [
  {
    name: "Free",
    price: "$0",
    description: "Limited usage with access to essential templates.",
  },
  {
    name: "Pro",
    price: "$10 / month",
    description: "Full access to every mini-app with priority updates.",
  },
  {
    name: "Elite",
    price: "$50 / year",
    description: "All features, annual savings, and early access to launches.",
  },
];
---

<Layout>
  <main class="bg-slate-950 text-white">
    <section class="relative isolate overflow-hidden">
      <div class="absolute inset-0 -z-10 bg-gradient-to-br from-indigo-600/60 via-sky-500/40 to-purple-600/60 blur-3xl opacity-70"></div>
      <div class="absolute inset-0 -z-10 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.14),_rgba(15,23,42,0.95))]"></div>
      <div class="relative mx-auto flex max-w-6xl flex-col gap-12 px-4 pb-16 pt-20 sm:px-6 lg:px-8 lg:flex-row lg:items-end">
        <div class="flex-1">
          <p class="inline-flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.35em] text-white/80">
            Ansiversa
          </p>
          <h1 class="mt-6 text-4xl font-black leading-tight sm:text-5xl lg:text-6xl">
            Ansiversa — The AI Universe of 100 Mini Apps
          </h1>
          <p class="mt-4 text-base font-semibold uppercase tracking-[0.3em] text-white/70">
            Advanced Next-Gen Software Innovation
          </p>
          <p class="mt-6 max-w-2xl text-lg text-white/80">{mission}</p>
          <div class="mt-10 flex flex-wrap gap-4">
            <a
              href="#mini-apps"
              class="inline-flex items-center justify-center gap-2 rounded-full bg-white px-6 py-3 text-sm font-semibold text-slate-950 shadow-xl shadow-indigo-500/30 transition hover:-translate-y-0.5 hover:bg-slate-100"
            >
              Browse mini-apps
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                aria-hidden="true"
                focusable="false"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="m8.25 4.5 7.5 7.5-7.5 7.5"
                />
              </svg>
            </a>
            <a
              href="/app/pricing"
              class="inline-flex items-center justify-center gap-2 rounded-full border border-white/30 px-6 py-3 text-sm font-semibold text-white/80 backdrop-blur transition hover:border-white/60 hover:text-white"
            >
              View pricing
            </a>
          </div>
        </div>
        <div class="w-full max-w-sm rounded-3xl border border-white/10 bg-white/10 p-6 shadow-2xl shadow-indigo-900/40 backdrop-blur">
          <div class="flex items-center justify-between text-xs uppercase tracking-[0.3em] text-white/60">
            <span class="inline-flex items-center gap-2">
              <span class="h-2 w-2 rounded-full bg-emerald-400"></span>
              AI-powered
            </span>
            <span>Mini-app hub</span>
          </div>
          <div class="mt-6 space-y-3 text-sm text-white/80">
            <p class="rounded-2xl border border-white/15 bg-white/10 px-4 py-3">
              100 mini-apps for study, career, creativity, productivity, lifestyle, and fun.
            </p>
            <p class="rounded-2xl border border-white/15 bg-white/10 px-4 py-3">
              Unified Ansiversa design system keeps every mini-app feeling cohesive and intuitive.
            </p>
            <p class="rounded-2xl border border-white/15 bg-white/10 px-4 py-3">
              One subscription keeps the entire ecosystem updated and in sync.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="mini-apps" class="bg-slate-100 py-16 text-slate-950">
      <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
        <div class="text-center">
          <h2 class="text-3xl font-bold tracking-tight sm:text-4xl">Explore our apps</h2>
          <p class="mt-3 text-base text-slate-600">
            Browse 100 focused tools spanning learning, career, creativity, productivity, wellness, and play — all crafted in-house for cohesion and speed.
          </p>
        </div>
        <div class="mt-12 grid gap-6">
          {categorizedMiniApps.map((category) => (
            <article class="group relative overflow-hidden rounded-3xl border border-slate-200 bg-white/90 p-6 shadow-soft transition hover:-translate-y-1 hover:shadow-xl">
              <div class={`absolute inset-x-6 top-0 h-1.5 bg-gradient-to-r ${category.accent} opacity-90`}></div>
              <div class="mt-5 flex flex-col gap-3">
                <h3 class="text-xl font-semibold text-slate-900">{category.name}</h3>
                <p class="text-sm text-slate-600">{category.blurb}</p>
              </div>
              <ul class="mt-6 grid gap-2 text-sm font-medium text-slate-700 sm:grid-cols-2 lg:grid-cols-3">
                {category.apps.map((app) => (
                  <li
                    class={`flex items-center gap-3 rounded-2xl px-3 py-2 transition ${
                      app.available
                        ? 'bg-slate-50/80 text-slate-700 group-hover:bg-slate-100'
                        : 'bg-slate-100 text-slate-400'
                    }`}
                  >
                    <span class={`inline-flex h-2 w-2 flex-shrink-0 rounded-full bg-gradient-to-r ${category.accent}`}></span>
                    {app.available && app.href ? (
                      <a
                        href={app.href}
                        class="inline-flex items-center gap-2 text-slate-700 hover:text-indigo-600"
                      >
                        <span>{app.name}</span>
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          class="h-3.5 w-3.5"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="1.5"
                          aria-hidden="true"
                          focusable="false"
                        >
                          <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                        </svg>
                      </a>
                    ) : (
                      <span class="inline-flex items-center gap-2 text-slate-400">
                        <span>{app.name}</span>
                      </span>
                    )}
                  </li>
                ))}
              </ul>
            </article>
          ))}
        </div>
      </div>
    </section>

    <section class="relative overflow-hidden bg-slate-950 py-16">
      <div class="absolute inset-0 -z-10 bg-gradient-to-br from-indigo-600/60 via-sky-500/40 to-purple-600/60 blur-3xl opacity-60"></div>
      <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
        <div class="rounded-[34px] border border-white/10 bg-white/5 p-10 text-white shadow-2xl shadow-indigo-950/40 backdrop-blur">
          <div class="text-center">
            <p class="text-xs font-semibold uppercase tracking-[0.35em] text-white/70">Subscriptions</p>
            <h2 class="mt-4 text-3xl font-bold">Plans that scale with every creator</h2>
            <p class="mt-3 text-base text-white/70">
              Join for free or unlock the complete ecosystem with Pro or Elite tiers.
            </p>
          </div>
          <div class="mt-10 grid gap-6 md:grid-cols-3">
            {plans.map((plan) => (
              <div class="rounded-3xl border border-white/15 bg-white/10 p-6 text-left shadow-xl shadow-indigo-900/30 transition hover:-translate-y-1 hover:bg-white/15">
                <p class="text-sm font-semibold uppercase tracking-wide text-white/70">{plan.name}</p>
                <p class="mt-3 text-2xl font-bold text-white">{plan.price}</p>
                <p class="mt-3 text-sm text-white/70">{plan.description}</p>
              </div>
            ))}
          </div>
          <div class="mt-10 flex flex-wrap justify-center gap-4 text-sm font-semibold">
            <a href="/app/signup" class="inline-flex items-center justify-center rounded-full bg-white px-6 py-3 text-slate-950 shadow-lg shadow-indigo-500/30 transition hover:-translate-y-0.5 hover:bg-slate-100">
              Create a free account
            </a>
            <a href="/app/pricing" class="inline-flex items-center justify-center rounded-full border border-white/30 px-6 py-3 text-white/80 backdrop-blur transition hover:border-white/60 hover:text-white">
              Compare all features
            </a>
          </div>
        </div>
      </div>
    </section>

    <footer class="border-t border-slate-800 bg-slate-950 py-10 text-sm text-white/70">
      <div class="mx-auto flex max-w-5xl flex-col items-center justify-between gap-4 px-4 text-center sm:flex-row sm:text-left">
        <div>
          <p class="text-xs uppercase tracking-[0.35em] text-white/50">Stay connected</p>
          <p class="mt-2 font-semibold text-white">Ansiversa — Innovation in every click.</p>
        </div>
        <div class="space-y-1">
          <a href="https://www.ansiversa.com" class="block text-white transition hover:text-indigo-300">ansiversa.com</a>
          <a href="mailto:contact@ansiversa.com" class="block text-white transition hover:text-indigo-300">contact@ansiversa.com</a>
        </div>
      </div>
    </footer>
  </main>
</Layout>
