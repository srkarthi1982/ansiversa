---
import Button from "../../components/Button.astro";
---
<section class="space-y-6 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
  <header class="flex items-start justify-between gap-3">
    <div class="space-y-1">
      <h2 class="text-lg font-semibold text-slate-900">SEO assistant</h2>
      <p class="text-sm text-slate-600">Auto-generate slugs, metadata, and recommendations tailored to your outline.</p>
    </div>
    <Button type="button" size="sm" variant="outline" @click.prevent="$store['blog-writer'].generateSeoInsights()">
      <i class="fas fa-gauge-high text-xs"></i>
      Refresh score
    </Button>
  </header>
  <div class="space-y-4">
    <div class="space-y-2">
      <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">Slug</label>
      <input
        type="text"
        class="w-full rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 shadow-sm focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-100"
        placeholder="your-post-slug"
        :value="$store['blog-writer'].builder.record.seo.slug"
        @input="$store['blog-writer'].builder.record.seo.slug = $event.target.value; $store['blog-writer'].touchBuilder()"
      />
    </div>
    <div class="space-y-2">
      <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">Meta description</label>
      <textarea
        rows="3"
        class="w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-100"
        :value="$store['blog-writer'].builder.record.seo.description"
        @input="$store['blog-writer'].builder.record.seo.description = $event.target.value; $store['blog-writer'].touchBuilder()"
      ></textarea>
      <p class="text-xs text-slate-500">
        <span x-text="$store['blog-writer'].builder.record.seo.description.length"></span>
        / 160 characters
      </p>
    </div>
    <div class="space-y-2">
      <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">Keywords</label>
      <div class="flex flex-wrap gap-2">
        <template x-for="keyword in $store['blog-writer'].builder.record.seo.keywords" :key="`keyword-${keyword}`">
          <span class="inline-flex items-center gap-2 rounded-full bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700">
            <span x-text="keyword"></span>
            <button type="button" class="text-emerald-500 hover:text-emerald-700" @click.prevent="$store['blog-writer'].removeKeyword(keyword)">
              <i class="fas fa-times text-[10px]"></i>
            </button>
          </span>
        </template>
        <input
          type="text"
          class="min-w-[140px] flex-1 rounded-full border border-dashed border-emerald-300 bg-white px-3 py-1 text-xs text-slate-600 focus:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-100"
          placeholder="Add keyword"
          :value="$store['blog-writer'].builder.keywordDraft"
          @input="$store['blog-writer'].builder.keywordDraft = $event.target.value"
          @keydown.enter.prevent="$store['blog-writer'].addKeyword($store['blog-writer'].builder.keywordDraft)"
          @blur="$store['blog-writer'].addKeyword($store['blog-writer'].builder.keywordDraft)"
        />
      </div>
    </div>
    <div class="grid gap-3 sm:grid-cols-2">
      <div class="rounded-2xl border border-slate-200 bg-slate-50 p-3">
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">SEO score</p>
        <p class="mt-2 text-2xl font-bold text-slate-900">
          <span x-text="$store['blog-writer'].builder.record.seo.score"></span>
          <span class="ml-1 text-sm font-medium text-slate-500">/100</span>
        </p>
      </div>
      <div class="rounded-2xl border border-slate-200 bg-slate-50 p-3">
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Readability</p>
        <p class="mt-2 text-lg font-semibold text-slate-900">
          <span x-text="$store['blog-writer'].builder.record.seo.readability"></span>
          <span class="ml-1 text-xs text-slate-500">grade</span>
        </p>
      </div>
    </div>
    <div class="space-y-2">
      <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Insights</p>
      <template x-if="$store['blog-writer'].builder.seoInsights.length === 0">
        <p class="rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-4 text-xs text-slate-500">
          Run the assistant to see keyword density, metadata, and linking opportunities.
        </p>
      </template>
      <ul class="space-y-3">
        <template x-for="insight in $store['blog-writer'].builder.seoInsights" :key="insight.id">
          <li class="flex items-start gap-3 rounded-2xl border border-slate-100 bg-white p-3 shadow-sm">
            <span class="mt-1 inline-flex h-7 w-7 items-center justify-center rounded-full" :class="insight.positive ? 'bg-emerald-100 text-emerald-600' : 'bg-amber-100 text-amber-600'">
              <i class="fas" :class="insight.positive ? 'fa-circle-check' : 'fa-circle-info'"></i>
            </span>
            <div class="space-y-1 text-xs text-slate-600">
              <p class="font-semibold text-slate-900" x-text="insight.label"></p>
              <p x-text="insight.suggestion"></p>
            </div>
          </li>
        </template>
      </ul>
    </div>
  </div>
</section>
