---
import Layout from '../../layouts/Layout.astro';
import Button from '../../components/Button.astro';
import SectionHeading from '../../components/SectionHeading.astro';

const proBenefits = [
  'Unlimited generations and saved profiles',
  'Advanced linting (bias, buzzword, authenticity)',
  'Markdown + PDF exports without watermark',
  'Localization packs (Arabic, Tamil, Spanish) and emoji styles',
  'One-click pushes to Resume Builder, Cover Letter Writer, Portfolio Creator, and Email Polisher',
];
---

<Layout>
  <a
    class="sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-4 focus:rounded-md focus:bg-white focus:px-4 focus:py-2 focus:text-sm focus:font-semibold focus:text-slate-900 focus:outline-none focus:ring-2 focus:ring-indigo-500"
    href="#linkedin-bio-settings"
  >
    Skip to LinkedIn Bio settings
  </a>
  <main
    id="linkedin-bio-settings"
    class="min-h-screen bg-slate-50"
    x-data="() => ({ linkedinBio: $store.linkedinBio })"
    x-init="linkedinBio.initSettings()"
  >
    <section class="relative overflow-hidden py-16 sm:py-20">
      <div class="absolute inset-0 bg-gradient-to-br from-indigo-100 via-white to-transparent"></div>
      <div class="relative mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
        <div class="space-y-6 text-center">
          <span class="inline-flex items-center gap-2 rounded-full bg-indigo-100 px-4 py-1.5 text-sm font-semibold text-indigo-700">
            <i class="fas fa-gear text-xs"></i>
            LinkedIn Bio Optimizer Â· Settings
          </span>
          <h1 class="text-4xl font-bold tracking-tight text-slate-900 sm:text-5xl">Workspace preferences</h1>
          <p class="text-base text-slate-600 sm:text-lg">
            Configure default tone, persona, localization, and compliance controls. Changes apply across new generations while keeping existing history intact.
          </p>
          <div class="flex flex-wrap justify-center gap-3">
            <Button variant="outline" href="/linkedin-bio">
              <i class="fas fa-arrow-left text-xs"></i>
              Back to overview
            </Button>
            <Button
              variant="ghost"
              x-bind:href="`/linkedin-bio/editor/${linkedinBio.activeProfile?.id ?? ''}`"
            >
              <i class="fas fa-sliders text-xs"></i>
              Open editor
            </Button>
          </div>
        </div>
      </div>
    </section>

    <section class="pb-20">
      <div class="mx-auto max-w-5xl space-y-10 px-4 sm:px-6 lg:px-8">
        <div class="grid gap-6 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,0.9fr)]">
          <article class="space-y-6 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
            <SectionHeading
              eyebrow="Tone & persona"
              title="Define your default voice"
              description="Adjust tone stack, persona, emoji policy, and localization. Variants snap to these defaults when generated."
            />
            <div class="space-y-4 text-sm text-slate-700">
              <div>
                <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Persona</p>
                <div class="mt-2 flex flex-wrap gap-2">
                  <template x-for="option in linkedinBio.personaOptions" :key="option.value">
                    <button
                      type="button"
                      class="inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold transition"
                      :class="linkedinBio.isPersonaActive(option.value) ? 'border-slate-900 bg-slate-900 text-white shadow-sm' : 'border-slate-200 bg-white text-slate-600 hover:border-indigo-200 hover:text-indigo-700'"
                      @click="linkedinBio.setPersona(option.value)"
                    >
                      <i class="fas fa-user text-[10px]"></i>
                      <span x-text="option.label"></span>
                    </button>
                  </template>
                </div>
              </div>
              <div>
                <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Tone stack</p>
                <div class="mt-2 flex flex-wrap gap-2">
                  <template x-for="option in linkedinBio.toneOptions" :key="option.value">
                    <button
                      type="button"
                      class="inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold transition"
                      :class="linkedinBio.isToneSelected(option.value) ? 'border-indigo-300 bg-indigo-50 text-indigo-700 shadow-sm' : 'border-slate-200 bg-white text-slate-600 hover:border-indigo-200 hover:text-indigo-700'"
                      @click="linkedinBio.toggleTone(option.value)"
                    >
                      <i class="fas text-[10px]" :class="option.icon"></i>
                      <span x-text="option.label"></span>
                    </button>
                  </template>
                </div>
              </div>
              <div class="grid gap-4 sm:grid-cols-2">
                <label class="flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3 text-xs text-slate-600">
                  <span class="font-semibold text-slate-700">Language</span>
                  <select
                    class="rounded-lg border border-slate-200 bg-white px-3 py-2 font-semibold text-slate-700 focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-200"
                    x-model="linkedinBio.state.language"
                    @change="linkedinBio.setLanguage($event.target.value)"
                  >
                    <template x-for="option in linkedinBio.languageOptions" :key="option.value">
                      <option :value="option.value" x-text="`${option.label} (${option.locale})`"></option>
                    </template>
                  </select>
                </label>
                <div class="rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3 text-xs text-slate-600">
                  <p class="font-semibold text-slate-700">Emoji policy</p>
                  <p class="mt-1">Toggle to append curated emoji to supported variants.</p>
                  <button
                    type="button"
                    class="mt-3 inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold transition"
                    :class="linkedinBio.state.emoji ? 'border-emerald-300 bg-emerald-50 text-emerald-700 shadow-sm' : 'border-slate-200 bg-white text-slate-600 hover:border-indigo-200 hover:text-indigo-700'"
                    @click="linkedinBio.toggleEmoji()"
                  >
                    <i class="fas fa-face-smile"></i>
                    <span x-text="linkedinBio.state.emoji ? 'Enabled' : 'Disabled'"></span>
                  </button>
                </div>
              </div>
              <div class="rounded-2xl border border-slate-200 bg-white/80 p-4 text-xs text-slate-600">
                <p class="font-semibold text-slate-700">Tone intensity</p>
                <p class="mt-1">Adjust the weighting the generator applies when re-running variants.</p>
                <div class="mt-3 space-y-3">
                  <template x-for="axis in Object.keys(linkedinBio.state.toneIntensity)" :key="`settings-tone-${axis}`">
                    <div>
                      <div class="flex items-center justify-between">
                        <span class="capitalize" x-text="axis.replace(/([A-Z])/g, ' $1')"></span>
                        <span class="font-semibold text-slate-700" x-text="`${linkedinBio.state.toneIntensity[axis]}%`"></span>
                      </div>
                      <input
                        type="range"
                        min="0"
                        max="100"
                        class="mt-1 h-1 w-full cursor-pointer appearance-none rounded-full bg-indigo-100"
                        x-model.number="linkedinBio.state.toneIntensity[axis]"
                        @input="linkedinBio.setToneIntensity(axis, Number($event.target.value))"
                      />
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </article>
          <aside class="space-y-6">
            <article class="space-y-4 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
              <SectionHeading
                eyebrow="Plan"
                title="Upgrade for full control"
                description="Unlock unlimited profiles, exports, and advanced linting with Pro."
              />
              <ul class="space-y-2 text-sm text-slate-600">
                {proBenefits.map((benefit) => (
                  <li class="flex items-start gap-2">
                    <i class="fas fa-star text-[10px] text-indigo-500"></i>
                    <span>{benefit}</span>
                  </li>
                ))}
              </ul>
              <Button variant="outline" @click="linkedinBio.setPlan('pro')">
                <i class="fas fa-rocket text-xs"></i>
                Switch to Pro
              </Button>
            </article>
            <article class="space-y-4 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
              <SectionHeading
                eyebrow="Profiles"
                title="Plan-locked profiles"
                description="Free plans can keep one active profile. Upgrade to access additional profiles."
              />
              <template x-if="linkedinBio.planLockedProfiles.length === 0">
                <p class="rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3 text-xs text-slate-500">
                  No profiles are locked. Upgrade to Pro to add more saved personas and localization packs.
                </p>
              </template>
              <ul class="space-y-3" x-show="linkedinBio.planLockedProfiles.length" x-cloak>
                <template x-for="profile in linkedinBio.planLockedProfiles" :key="profile.id">
                  <li class="rounded-2xl border border-slate-200 bg-white px-4 py-3 text-xs text-slate-600">
                    <p class="text-sm font-semibold text-slate-900" x-text="profile.title"></p>
                    <p class="mt-1" x-text="profile.targets.roles.join(', ')"></p>
                    <p class="mt-1 text-slate-500" x-text="profile.preferences.language.toUpperCase()"></p>
                  </li>
                </template>
              </ul>
            </article>
          </aside>
        </div>
        <div class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
          <SectionHeading
            eyebrow="Compliance"
            title="Automatic guardrails"
            description="Authenticity and privacy controls apply to every generation."
          />
          <ul class="mt-4 grid gap-4 sm:grid-cols-2 text-sm text-slate-600">
            <li class="flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3">
              <i class="fas fa-shield-check mt-1 text-xs text-indigo-500"></i>
              <span>Claims without evidence are flagged before saving; aspirational mode rewrites with goal-oriented phrasing.</span>
            </li>
            <li class="flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3">
              <i class="fas fa-scale-balanced mt-1 text-xs text-indigo-500"></i>
              <span>Exports sanitize Markdown/PDF, strip confidential data, and enforce watermarking for free plans.</span>
            </li>
            <li class="flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3">
              <i class="fas fa-universal-access mt-1 text-xs text-indigo-500"></i>
              <span>Accessibility features include skip links, screen reader labels, and keyboard shortcuts for every action.</span>
            </li>
            <li class="flex items-start gap-3 rounded-2xl border border-slate-200 bg-slate-50/70 px-4 py-3">
              <i class="fas fa-file-shield mt-1 text-xs text-indigo-500"></i>
              <span>History keeps audit trails for generate, score, save, export, and publish events with timestamps and plan gating.</span>
            </li>
          </ul>
        </div>
      </div>
    </section>
  </main>
</Layout>
