---
import SectionHeading from '../../../components/SectionHeading.astro';
---
<section class="bg-slate-50 py-16 sm:py-20">
  <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
    <SectionHeading
      eyebrow="APIs & architecture"
      title="Routes powering the guided experience"
      description="Astro SSR routes orchestrate OCR, solving, hint reveal, practice generation, and exports — each with guardrails baked in."
    />
    <div class="mt-10 grid gap-8 lg:grid-cols-2">
      <div class="space-y-4 rounded-3xl border border-slate-200 bg-white p-6 shadow-soft">
        <h3 class="text-lg font-semibold text-slate-900">Primary API routes</h3>
        <ul class="space-y-3 text-sm text-slate-600">
          <li class="flex items-start gap-3">
            <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-indigo-500/10 text-indigo-600">
              <i class="fas fa-camera"></i>
            </span>
            <div>
              <p class="font-semibold text-slate-800">POST /homework-helper/api/ocr</p>
              <p>Extract text from uploaded images, returns editable transcription with confidence markers.</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-indigo-500/10 text-indigo-600">
              <i class="fas fa-route"></i>
            </span>
            <div>
              <p class="font-semibold text-slate-800">POST /homework-helper/api/solve</p>
              <p>Generates topic detection, difficulty score, and Step 1 scaffolding with KaTeX-friendly markdown.</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-indigo-500/10 text-indigo-600">
              <i class="fas fa-forward-step"></i>
            </span>
            <div>
              <p class="font-semibold text-slate-800">POST /homework-helper/api/step/next</p>
              <p>Progressive reveal engine — validates honour code, returns the next step body + hint variations.</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-indigo-500/10 text-indigo-600">
              <i class="fas fa-microscope"></i>
            </span>
            <div>
              <p class="font-semibold text-slate-800">POST /homework-helper/api/check</p>
              <p>Compares a learner attempt, highlights mistake zones, and suggests corrective prompts.</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-indigo-500/10 text-indigo-600">
              <i class="fas fa-sparkles"></i>
            </span>
            <div>
              <p class="font-semibold text-slate-800">POST /homework-helper/api/practice/generate</p>
              <p>Returns 3–5 practice problems with concise solutions and skill tags for differentiation.</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-indigo-500/10 text-indigo-600">
              <i class="fas fa-file-export"></i>
            </span>
            <div>
              <p class="font-semibold text-slate-800">POST /homework-helper/api/export</p>
              <p>Assembles PDF/Markdown study sheets and FlashNote decks with citation footers.</p>
            </div>
          </li>
        </ul>
      </div>
      <div class="space-y-4 rounded-3xl border border-slate-200 bg-white p-6 shadow-soft">
        <h3 class="text-lg font-semibold text-slate-900">Data model snapshot</h3>
        <p class="text-sm text-slate-600">
          Astro DB models capture problems, solution plans, attempts, and practice sets. Flags and settings routes close the loop
          for moderation and personalization.
        </p>
        <div class="overflow-x-auto rounded-2xl border border-slate-200 bg-slate-50 p-4 text-[13px] text-slate-700">
          <pre class="whitespace-pre-wrap">
User
├─ id (pk)
├─ email
├─ plan ('free'|'pro')
├─ role ('student'|'teacher'|'parent')
├─ board, gradeBand, language, units
└─ createdAt

Problem
├─ id (uuid pk)
├─ userId (fk)
├─ subject, text, images, detectedTopic
├─ gradeBand, difficulty, createdAt

SolutionPlan
├─ id (uuid pk)
├─ problemId (fk)
├─ status, steps[], finalAnswer, hints[], citations[]
├─ explanations, safetyTags, createdAt

Attempt
├─ id (uuid pk)
├─ problemId (fk), userId (fk)
├─ workMd, result&#123;correct, diff[]&#125;, createdAt

PracticeSet
├─ id (uuid pk)
├─ userId (fk)
├─ subject, items[&#123;q, a, stepsMd&#125;], createdAt

Settings
├─ id (pk), userId (fk)
├─ board, gradeBand, language, units

Flag
├─ id (pk), problemId (fk)
├─ userId (fk|null), reason, details
└─ status ('new'|'triaged'|'fixed')
          </pre>
        </div>
        <div class="rounded-2xl bg-indigo-50/70 p-4 text-xs text-slate-600">
          <p class="font-semibold text-indigo-900">Safety first</p>
          <p class="mt-1">Each response carries a learning disclaimer, monitors hint abuse, and routes flagged items for human review.</p>
        </div>
      </div>
    </div>
  </div>
</section>
