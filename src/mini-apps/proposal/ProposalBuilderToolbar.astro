---
import Button from '../../components/Button.astro';
---
<section class="sticky top-[72px] z-30 border-b border-slate-200 bg-white/90 backdrop-blur">
  <div class="mx-auto flex flex-col gap-4 px-4 py-4 sm:px-6 lg:px-8 lg:flex-row lg:items-center lg:justify-between">
    <div class="flex flex-1 flex-col gap-3 lg:flex-row lg:items-center">
      <div class="lg:w-80">
        <label class="block text-xs font-semibold uppercase tracking-wide text-slate-500">
          Proposal title
          <input
            type="text"
            class="mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-900 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"
            :value="$store.proposal.builder.title"
            @input="$store.proposal.updateTitle($event.target.value)"
          />
        </label>
      </div>
      <div class="grid flex-1 grid-cols-1 gap-3 sm:grid-cols-3">
        <label class="flex flex-col gap-1 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm">
          Template
          <select
            class="w-full appearance-none rounded-md border-none bg-transparent text-sm font-semibold text-slate-900 focus:outline-none"
            :value="$store.proposal.builder.templateKey"
            @change="$store.proposal.updateTemplate($event.target.value)"
          >
            <template x-for="template in $store.proposal.templates" :key="template.key">
              <option :value="template.key" x-text="template.label"></option>
            </template>
          </select>
        </label>
        <label class="flex flex-col gap-1 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm">
          Currency
          <input
            type="text"
            maxlength="3"
            class="w-full rounded-md border-none bg-transparent text-sm font-semibold uppercase text-slate-900 focus:outline-none"
            :value="$store.proposal.builder.currency"
            @input="$store.proposal.updateCurrency($event.target.value)"
          />
        </label>
        <label class="flex flex-col gap-1 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-500 shadow-sm">
          Tone
          <select
            class="w-full appearance-none rounded-md border-none bg-transparent text-sm font-semibold text-slate-900 focus:outline-none"
            :value="$store.proposal.builder.aiTone"
            @change="$store.proposal.builder.aiTone = $event.target.value"
          >
            <option value="professional">Professional</option>
            <option value="friendly">Friendly</option>
            <option value="concise">Concise</option>
            <option value="bold">Bold</option>
            <option value="empathetic">Empathetic</option>
          </select>
        </label>
      </div>
    </div>
    <div class="flex flex-wrap items-center gap-3">
      <div class="text-xs text-slate-500" x-text="$store.proposal.builder.autosaveLabel ?? ''"></div>
      <Button
        type="button"
        variant="ghost"
        class="min-w-[110px]"
        @click.prevent="$store.proposal.saveNow()"
      >
        <i class="fas fa-floppy-disk text-xs"></i>
        Save now
      </Button>
      <Button
        type="button"
        variant="ghost"
        class="min-w-[140px]"
        @click.prevent="$store.proposal.runAIDraft({ client: $store.proposal.builder.data.client.name })"
        :disabled="$store.proposal.builder.aiBusy"
      >
        <i class="fas fa-sparkles text-xs"></i>
        AI draft
      </Button>
      <div class="hidden h-6 w-px bg-slate-200 md:block"></div>
      <Button
        type="button"
        variant="ghost"
        class="min-w-[110px]"
        @click.prevent="$store.proposal.export('pdf')"
      >
        <i class="fas fa-file-export text-xs"></i>
        Export
      </Button>
      <Button
        type="button"
        @click.prevent="$store.proposal.publishCurrent()"
        :disabled="!$store.proposal.builder.id"
      >
        <i class="fas fa-earth-americas text-xs"></i>
        Publish
      </Button>
    </div>
  </div>
</section>
