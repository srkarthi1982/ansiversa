---
import {
  qrContentTypes,
  qrGradientPresets,
} from '../../../lib/qr-code-creator/constants';
---
<section class="space-y-8 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
  <header class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h2 class="text-xl font-semibold text-slate-900">Content and styling</h2>
      <p class="text-sm text-slate-600">
        Choose the payload type, fill the guided form, then style your QR code with brand colors, gradients, and logos.
      </p>
    </div>
    <div class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-4 py-2 text-xs font-semibold uppercase tracking-wider text-slate-600">
      <span class="inline-flex items-center gap-2">
        <span class="h-2 w-2 rounded-full bg-emerald-500"></span>
        <span x-text="$store['qr-code-creator'].state.mode === 'dynamic' ? 'Dynamic QR' : 'Static QR'"></span>
      </span>
      <span class="hidden sm:inline">·</span>
      <span class="inline-flex items-center gap-2">
        <i class="fas fa-gem text-[10px] text-indigo-500"></i>
        <span x-text="$store['qr-code-creator'].state.plan.toUpperCase()"></span>
      </span>
    </div>
  </header>

  <div class="grid gap-6 lg:grid-cols-[1.2fr_0.8fr]">
    <div class="space-y-6">
      <div class="rounded-2xl border border-slate-200 p-4">
        <div class="flex flex-wrap items-center justify-between gap-3">
          <h3 class="text-sm font-semibold text-slate-900">Generation mode</h3>
          <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-[11px] font-semibold text-slate-600">
            <i class="fas fa-bolt text-[10px] text-indigo-500"></i>
            Switch between static and dynamic QR experiences.
          </div>
        </div>
        <div class="mt-4 grid gap-3 sm:grid-cols-2">
          <button
            type="button"
            class="flex items-start gap-3 rounded-2xl border px-4 py-3 text-left transition"
            :class="$store['qr-code-creator'].state.mode === 'static' ? 'border-indigo-500 bg-indigo-50/60 shadow-sm' : 'border-slate-200 bg-white hover:border-slate-300'"
            @click="$store['qr-code-creator'].setMode('static')"
          >
            <span class="flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-100 text-indigo-600">
              <i class="fas fa-qrcode"></i>
            </span>
            <span>
              <span class="block text-sm font-semibold text-slate-900">Static</span>
              <span class="text-xs text-slate-600">Encoded content with no analytics. Best for simple print runs.</span>
            </span>
          </button>
          <button
            type="button"
            class="flex items-start gap-3 rounded-2xl border px-4 py-3 text-left transition"
            :class="$store['qr-code-creator'].state.mode === 'dynamic' ? 'border-indigo-500 bg-indigo-50/60 shadow-sm' : 'border-slate-200 bg-white hover:border-slate-300'"
            @click="$store['qr-code-creator'].setMode('dynamic')"
          >
            <span class="flex h-10 w-10 items-center justify-center rounded-xl bg-purple-100 text-purple-600">
              <i class="fas fa-link"></i>
            </span>
            <span>
              <span class="block text-sm font-semibold text-slate-900">Dynamic</span>
              <span class="text-xs text-slate-600">Short link redirects with retargeting, passwords, and analytics.</span>
            </span>
          </button>
        </div>
      </div>

      <div class="space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-sm font-semibold text-slate-900">Content type</h3>
          <span class="text-xs font-semibold uppercase tracking-wide text-indigo-500">{qrContentTypes.length} options</span>
        </div>
        <div class="grid gap-3 sm:grid-cols-2 xl:grid-cols-3">
          {qrContentTypes.map((definition) => (
            <button
              type="button"
              class="group flex flex-col gap-2 rounded-2xl border p-4 text-left transition"
              :class="$store['qr-code-creator'].state.contentType === definition.id ? 'border-indigo-500 bg-indigo-50/70 shadow-sm' : 'border-slate-200 bg-white hover:border-slate-300'"
              @click="$store['qr-code-creator'].setContentType(definition.id)"
              key={definition.id}
            >
              <div class="flex items-center gap-3">
                <span class="flex h-8 w-8 items-center justify-center rounded-xl bg-slate-100 text-slate-600 group-hover:bg-indigo-100 group-hover:text-indigo-600">
                  <i class={`${definition.icon} text-sm`}></i>
                </span>
                <span class="text-sm font-semibold text-slate-900">{definition.label}</span>
              </div>
              <p class="text-xs text-slate-600">{definition.description}</p>
              {definition.plan === 'pro' && (
                <span class="inline-flex items-center gap-1 self-start rounded-full bg-purple-100 px-2.5 py-1 text-[11px] font-semibold text-purple-600">
                  <i class="fas fa-gem text-[9px]"></i>
                  Pro
                </span>
              )}
            </button>
          ))}
        </div>
      </div>

      <div class="space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-sm font-semibold text-slate-900">Payload builder</h3>
          <div class="text-xs text-slate-500">
            <span x-text="$store['qr-code-creator'].contentDefinition.label"></span>
            <span> · </span>
            <span x-text="$store['qr-code-creator'].contentDefinition.samplePayload"></span>
          </div>
        </div>
        <div class="space-y-4">
          <template x-for="field in $store['qr-code-creator'].contentDefinition.fields" :key="field.key">
            <div class="space-y-1">
              <label class="text-xs font-semibold uppercase tracking-wide text-slate-600">
                <span x-text="field.label"></span>
                <template x-if="field.plan === 'pro'">
                  <span class="ml-2 inline-flex items-center gap-1 rounded-full bg-purple-100 px-2 py-0.5 text-[10px] font-semibold text-purple-600">
                    <i class="fas fa-gem text-[8px]"></i>
                    Pro
                  </span>
                </template>
              </label>
              <template x-if="field.type === 'text'">
                <input
                  type="text"
                  class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-indigo-500 focus:outline-none"
                  :placeholder="field.placeholder"
                  :value="$store['qr-code-creator'].state.values[field.key] ?? ''"
                  @input="$store['qr-code-creator'].updateField(field.key, $event.target.value)"
                  :disabled="field.plan === 'pro' && $store['qr-code-creator'].state.plan === 'free'"
                />
              </template>
              <template x-if="field.type === 'textarea'">
                <textarea
                  rows="3"
                  class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-indigo-500 focus:outline-none"
                  :placeholder="field.placeholder"
                  :value="$store['qr-code-creator'].state.values[field.key] ?? ''"
                  @input="$store['qr-code-creator'].updateField(field.key, $event.target.value)"
                  :maxlength="field.maxLength ?? null"
                  :disabled="field.plan === 'pro' && $store['qr-code-creator'].state.plan === 'free'"
                ></textarea>
              </template>
              <template x-if="field.type === 'select'">
                <select
                  class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-indigo-500 focus:outline-none"
                  :value="$store['qr-code-creator'].state.values[field.key] ?? ''"
                  @change="$store['qr-code-creator'].updateField(field.key, $event.target.value)"
                  :disabled="field.plan === 'pro' && $store['qr-code-creator'].state.plan === 'free'"
                >
                  <template x-for="option in field.options ?? []" :key="option.value">
                    <option :value="option.value" x-text="option.label"></option>
                  </template>
                </select>
              </template>
              <template x-if="field.type === 'toggle'">
                <label class="flex items-center gap-3 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-600">
                  <input
                    type="checkbox"
                    class="h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"
                    :checked="Boolean($store['qr-code-creator'].state.values[field.key])"
                    @change="$store['qr-code-creator'].updateField(field.key, $event.target.checked)"
                    :disabled="field.plan === 'pro' && $store['qr-code-creator'].state.plan === 'free'"
                  />
                  <span x-text="field.helper ?? 'Toggle option'"></span>
                </label>
              </template>
              <template x-if="field.helper && field.type !== 'toggle'">
                <p class="text-xs text-slate-500" x-text="field.helper"></p>
              </template>
            </div>
          </template>
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <div class="rounded-2xl border border-slate-200 bg-slate-50/60 p-4">
        <h3 class="text-sm font-semibold text-slate-900">Styling controls</h3>
        <p class="mt-1 text-xs text-slate-600">
          Tune colors, gradients, eye shapes, and quiet zones to match your brand while keeping scan reliability high.
        </p>
        <div class="mt-4 space-y-4">
          <div class="grid gap-3 sm:grid-cols-2">
            <label class="space-y-2">
              <span class="text-xs font-medium text-slate-600">Foreground</span>
              <input
                type="color"
                class="h-12 w-full rounded-xl border border-slate-200 bg-white p-2"
                :value="$store['qr-code-creator'].state.style.foreground"
                @input="$store['qr-code-creator'].updateStyle({ foreground: $event.target.value })"
              />
            </label>
            <label class="space-y-2">
              <span class="text-xs font-medium text-slate-600">Background</span>
              <input
                type="color"
                class="h-12 w-full rounded-xl border border-slate-200 bg-white p-2"
                :value="$store['qr-code-creator'].state.style.background"
                @input="$store['qr-code-creator'].updateStyle({ background: $event.target.value })"
              />
            </label>
          </div>

          <div class="space-y-2">
            <div class="flex items-center justify-between">
              <span class="text-xs font-medium text-slate-600">Gradient overlay</span>
              <label class="inline-flex items-center gap-2 text-xs text-slate-600">
                <input
                  type="checkbox"
                  class="h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"
                  :checked="$store['qr-code-creator'].state.style.gradientEnabled"
                  @change="$store['qr-code-creator'].toggleGradient($event.target.checked)"
                />
                Enable
              </label>
            </div>
            <div class="grid gap-3 sm:grid-cols-2">
              {qrGradientPresets.map((preset) => (
                <button
                  type="button"
                  class="flex items-center justify-between gap-3 rounded-2xl border px-3 py-2 text-left transition"
                  :class="$store['qr-code-creator'].state.style.gradient.from === preset.from && $store['qr-code-creator'].state.style.gradient.to === preset.to ? 'border-indigo-500 bg-indigo-50/70 shadow-sm' : 'border-slate-200 bg-white hover:border-slate-300'"
                  @click="$store['qr-code-creator'].setGradientPreset(preset.id)"
                  key={preset.id}
                >
                  <span class="flex flex-1 items-center gap-3">
                    <span
                      class="h-9 w-9 rounded-xl border border-white shadow-sm"
                      style={{ background: `linear-gradient(${preset.angle}deg, ${preset.from}, ${preset.to})` }}
                    ></span>
                    <span class="text-xs font-semibold text-slate-700">{preset.name}</span>
                  </span>
                  <i class="fas fa-chevron-right text-[10px] text-slate-400"></i>
                </button>
              ))}
            </div>
          </div>

          <div class="grid gap-3 sm:grid-cols-2">
            <label class="space-y-2">
              <span class="text-xs font-medium text-slate-600">Size</span>
              <select
                class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-indigo-500 focus:outline-none"
                :value="$store['qr-code-creator'].state.style.size"
                @change="$store['qr-code-creator'].updateStyle({ size: Number($event.target.value) })"
              >
                <template x-for="option in $store['qr-code-creator'].sizeOptions" :key="option.value">
                  <option :value="option.value" x-text="option.label"></option>
                </template>
              </select>
            </label>
            <label class="space-y-2">
              <span class="text-xs font-medium text-slate-600">Quiet zone</span>
              <select
                class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-indigo-500 focus:outline-none"
                :value="$store['qr-code-creator'].state.style.margin"
                @change="$store['qr-code-creator'].updateStyle({ margin: Number($event.target.value) })"
              >
                <template x-for="option in $store['qr-code-creator'].marginOptions" :key="option.value">
                  <option :value="option.value" x-text="option.label"></option>
                </template>
              </select>
            </label>
          </div>

          <div class="grid gap-3 sm:grid-cols-2">
            <label class="space-y-2">
              <span class="text-xs font-medium text-slate-600">Pattern style</span>
              <select
                class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-indigo-500 focus:outline-none"
                :value="$store['qr-code-creator'].state.style.dotStyle"
                @change="$store['qr-code-creator'].updateStyle({ dotStyle: $event.target.value })"
              >
                <template x-for="option in $store['qr-code-creator'].dotOptions" :key="option.value">
                  <option :value="option.value" x-text="option.label"></option>
                </template>
              </select>
            </label>
            <label class="space-y-2">
              <span class="text-xs font-medium text-slate-600">Finder eyes</span>
              <select
                class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:border-indigo-500 focus:outline-none"
                :value="$store['qr-code-creator'].state.style.eyeStyle"
                @change="$store['qr-code-creator'].updateStyle({ eyeStyle: $event.target.value })"
              >
                <template x-for="option in $store['qr-code-creator'].eyeOptions" :key="option.value">
                  <option :value="option.value" x-text="option.label"></option>
                </template>
              </select>
            </label>
          </div>

          <div class="space-y-2">
            <label class="text-xs font-medium text-slate-600">Logo overlay</label>
            <div class="flex flex-wrap items-center gap-3">
              <label class="inline-flex cursor-pointer items-center gap-2 rounded-xl border border-dashed border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-600 transition hover:border-indigo-400">
                <i class="fas fa-upload text-sm text-indigo-500"></i>
                Upload logo
                <input
                  type="file"
                  accept="image/png,image/jpeg,image/svg+xml"
                  class="hidden"
                  @change="$event.target.files?.[0] && $store['qr-code-creator'].setLogo($event.target.files[0])"
                />
              </label>
              <template x-if="$store['qr-code-creator'].state.style.logo">
                <div class="inline-flex items-center gap-2 rounded-xl bg-indigo-50 px-3 py-1.5 text-xs font-medium text-indigo-600">
                  <i class="fas fa-image text-[10px]"></i>
                  <span x-text="$store['qr-code-creator'].state.style.logo?.name"></span>
                  <button
                    type="button"
                    class="ml-1 text-indigo-500 hover:text-indigo-700"
                    @click="$store['qr-code-creator'].removeLogo()"
                  >
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </template>
            </div>
            <p class="text-xs text-slate-500">SVG or transparent PNG works best. Logo auto-centers with safe padding.</p>
          </div>
        </div>
      </div>

      <div class="rounded-2xl border border-indigo-100 bg-indigo-50/70 p-4 text-xs text-indigo-900">
        <h4 class="text-sm font-semibold">Scan assurance tips</h4>
        <ul class="mt-2 space-y-1">
          <li class="flex gap-2"><i class="fas fa-check text-indigo-500 mt-0.5 text-[10px]"></i>Keep contrast ratio above 4.5:1 between foreground and background.</li>
          <li class="flex gap-2"><i class="fas fa-check text-indigo-500 mt-0.5 text-[10px]"></i>Leave at least 2 modules of quiet zone for physical prints.</li>
          <li class="flex gap-2"><i class="fas fa-check text-indigo-500 mt-0.5 text-[10px]"></i>Upload logos smaller than 30% of total size to avoid obstructing finder eyes.</li>
        </ul>
      </div>
    </div>
  </div>
</section>
