---
import SectionHeading from "../../components/SectionHeading.astro";
import Button from "../../components/Button.astro";
---
<section id="plans" class="bg-slate-50 py-16 sm:py-20">
  <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
    <SectionHeading
      eyebrow="Plans"
      title="Choose how deep you go"
      description="Free covers focused launches with manual QA, while Pro unlocks advanced automation, localisation, A/B capacity, and ESP hand-offs."
    />
    <div class="mt-8 flex flex-wrap items-center justify-between gap-4 rounded-3xl border border-slate-200 bg-white px-6 py-5 shadow-sm">
      <div>
        <p class="text-sm font-semibold text-slate-900">Usage snapshot</p>
        <p class="text-xs text-slate-500">
          Issues
          <span class="font-semibold text-slate-900" x-text="`${emailNewsletter.state.usage.issuesUsed}/${emailNewsletter.state.usage.issuesLimit}`"></span>
          · Exports today
          <span class="font-semibold text-slate-900" x-text="`${emailNewsletter.state.usage.exportsUsed}/${emailNewsletter.state.usage.exportsLimit}`"></span>
          · Last export
          <span class="font-semibold text-slate-900" x-text="new Date(emailNewsletter.state.usage.lastExportAt).toLocaleString()"></span>
        </p>
      </div>
      <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 p-1 text-xs font-semibold text-slate-600">
        <button
          type="button"
          class="rounded-full px-4 py-2 transition"
          :class="emailNewsletter.state.plan === 'free' ? 'bg-white text-slate-900 shadow-sm' : 'hover:bg-white/70'"
          @click.prevent="emailNewsletter.togglePlan('free')"
        >
          Free
        </button>
        <button
          type="button"
          class="rounded-full px-4 py-2 transition"
          :class="emailNewsletter.state.plan === 'pro' ? 'bg-white text-slate-900 shadow-sm' : 'hover:bg-white/70'"
          @click.prevent="emailNewsletter.togglePlan('pro')"
        >
          Pro
        </button>
      </div>
      <Button href="/app/pricing" variant="outline" size="sm">
        Compare full pricing
      </Button>
    </div>
    <div class="mt-10 overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm">
      <table class="min-w-full divide-y divide-slate-200 text-sm text-slate-700">
        <thead class="bg-slate-50 text-xs font-semibold uppercase tracking-wide text-slate-500">
          <tr>
            <th class="px-6 py-4 text-left">Feature</th>
            <th class="px-6 py-4 text-left">Free</th>
            <th class="px-6 py-4 text-left">Pro</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-100">
          <template x-for="row in emailNewsletter.state.planMatrix" :key="row.feature">
            <tr class="hover:bg-slate-50/60">
              <td class="px-6 py-4 font-semibold text-slate-900" x-text="row.feature"></td>
              <td class="px-6 py-4" x-text="row.free"></td>
              <td class="px-6 py-4" x-text="row.pro"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
  </div>
</section>
